## Apple Account as a Data Source <!-- {docsify-ignore} -->

The Apple Account is the primary source of location data. It provides information related to the iPhones, iPads, Watches  and other devices in the Family Sharing list to iCloud3 devices that are tracked and monitored.



### Enable Location Sharing

An Apple iDevice must be configured correctly to be tracked by iCloud3. Location Sharing must be enabled.

- **Settings App > Apple Account > Family > Location Sharing** screen
  - Enable *Share your location with* and *Automatically Share Location*
- **FindMy App > Me** screen
  - Enable *Share My Location*

> The location of the devices you want to track with iCloud3 must be displayed on the Map on the *People* screen. If it is not displayed here, it's location is not shared correctly.



### Apple Account Authentication

When iCloud3 logs in the first time and about every 2-3 months after that, Apple will display the authentication screens on your iPhones, or iPads with the 6-digit verification code. The *Apple ID Sign in Requested* message is displayed on all of the devices that are configured as Trusted Devices. See [here](https://support.apple.com/en-us/HT205064) for additional information from Apple Support about your Trusted Devices.

If this popup window is repeatedly displayed, then Apple is not receiving the code properly or someone else with one of the Trusted Devices is responding before you do. In that case, You can ignore it if it is displayed with the same code you have submitted to Apple and Apple has accepted it.

> The 6-digit Verification Code is entered on the *Configure > Enter/Request an Apple Account Verification Code* screen. 

A *Verification Code Accepted* message is displayed if it is accepted by Apple. If not, reenter the code to try again. If the code rejected again (it is only good for about 15-minutes), you can request a new one which restart the authentication process with a new code.



### App Specific Passwords

App Specific Passwords can not be used with iCloud3. Apple does not provide an interface for web based programs like iCloud3 to use them. They can only be used with iPhone or iPad apps. You can not log into your Apple Account at www.icloud.com from a browser and use an App Specific Password.



### Hardware Security Keys like Yubikey

Hardware security keys can not be used with iCloud3 to authenticate access to your Apple Account. If are using a Yubikey or other hardware key for your Apple Account and get an authentication request or if you request a new verification code, you will get the window requesting Apple account access approval as you normally do. You can approve the access but there is no method of linking that approval to iCloud3.



### Tracking an Apple Watch


The Watch is tracked like any other iPhone or iPad. It is added on the *iCloud3 Devices* screen and configured on the *Update Devices* screen. 

Although the Mobile App Complication can be installed on the Apple Watch, there are a number of limitations regarding tracking :

- It does not provide location information.

- It will not receive notifications sent from iCloud3.

- Set the *Mobile App device* to *None*

- Set the *inZone Interval* to 15-minutes or less to minimize the delay when the device enters or exits a zone.

- Only assign a *Family Sharing* device to the tracked Watch device.

  

### Tracking AirTags

These devices can not be tracked. They are not tracked by Apple like an iPhone or iPad and location information is not returned from iCloud Location Services for them.



### Family Sharing vs Owner's Devices

> This applies only when you are tracking devices using several Apple Accounts. If only one Apple Account is being used, all devices in the Family Sharing List are located on each location request sent to Apple.

When a device needs to be located, iCloud3 sends a location request to iCloud. iCloud locates <u>all</u> devices on the Family Sharing List, not just the one that issued the request. iCloud3 receives the location information and updates all tracked and monitored devices with the new information.

However, when you are using several Apple Accounts and both apple accounts are sharing the same devices, you can limit the devices located during a location request to those 'owned' by that Apple Account. There are benefits and determents associated with each method.

- Improved response time when an Apple account's devices are being located since Apple does not have to locate all the devices in the Family Account. 
- Additional location requests must be sent to Apple to locate the devices on the other Apple account

For example: You have an Apple account with an iPhone and iPad (you are the owner) and your spouse has an iPhone and iPad (she is the owner).

- Family Sharing devices - You and your spouse's iPhones and iPads are located (4-devices) whenever one device is located. This can reduce the number of location requests sent to Apple, especially if the devices are close to each other.
- Owner's Devices - When one of your devices needs to be located, the location request sent to Apple only includes your iPhone and iPad (2-devices). Your spouse's devices are not located. The same is true when your spouse's devices are located.

> This is configured on the *Update Apple Account Username/Password* screen, *Always Locate All Devices* field.



### Event Log Family Share Information When iCloud3 Starts

When iCloud3 starts, Stage 4 of the startup process is to access the Apple Account. The following is done:

- Verify the Username/Password
- Read all of the devices in the Apple Account
- Match them up with the iCloud3 device using the Apple Account iCloud Device information from the *Update iCloud3 Device*
- Highlight and errors to include login errors, missing devices, authentication is required, changed device names, etc.

The results are shown in the *Event Log > Stage 4* screens.

![](../images/evlog-stage-4.png)



### Apple Account Cookie and Session Files

Apple Account cookies and session data is stored in the *config/.storage/icloud3.apple_acct* directory for each Apple Account being used. These *cookie* and *session* files store tokens that are used to access your iCloud account without requesting a 6-digit verification code every time you start iCloud3 or request location data.

Changing and deleting these files will cause reauthentication requests from Apple and termination of your current login session and should not generally be done. These files can be deleted on the *Configure > Tools* screen.



### China Users

A different URL is used to access the Apple Account servers in China (.cn is added to the URL).

> This is configured on the *Update Apple Account Username/Password* screen, *China Users* field.



### Upgrading to a new Device (Ex.: iPhone 15 to iPhone 16)

The device's name (*Gary iPhone*) selected from the above list is stored in the iCloud3 configuration file. This is used to determine the actual Apple device providing location data when iCloud3 starts.

Several events take place when you upgrade a device, i.e, replace an iPhone 15 with an iPhone 16. 
- The apps, data and settings are transferred from the iPhone 15 to the iPhone 16.
- In this example, the name is on the iPhone 16 Pro Max is *Gary iPhone*. 
- A new name is assigned to the iPhone 16 Pro Max, i.e, *Gary iPhone (2)*.
- The iPhone 15 is assigned a new *device_id* by Apple. This *device_id* is used internally by Apple and you never see it. It is used, however, by iCloud3 to identify the actual device providing location data.
- The iPhone 15 is removed from the *FindMy App* and the Apple iCloud account and traded-in or sold.

At this time, iCloud3 is still tracking the *Gary iPhone/iPhone 15* that is no longer on your iCloud account instead of the new iPhone.

**Easy way** - The following steps should be done to make it easier to identify and transfer to the new iPhone:

- Rename the iPhone 15 from *Gary iPhone* to *Gary iPhone 15*. 
- Rename the iPhone 16 Pro Max from *Gary iPhone 15 (2)* back to *Gary iPhone* after you transfer the apps, data and settings.
- Restart iCloud3.

Since the new iPhone 16 Pro Max is now the *Gary iPhone* device, it will be now be assigned to the same iCloud3 tracked device.

**Harder way** - You realize that *Gary iPhone* is no longer being tracked because the iPhone is no longer on your Apple iCloud account or it has been wiped and powered off. 
- Restart iCloud3 - The Apple Account device list will be rebuilt with the current name.
  - Reconfigure the iCloud3 device on the *Update iCloud3 Device* screen - Select the new iPhone from the Apple Account iCloud Device list. 
  - Exit the Configure screens - iCloud3 will be restarted and the new iPhone's name will be assigned to the iCloud3 tracked device.
- Or, 
  - Change the name on the iPhone 16 Pro Max from *Gary iPhone (2)* to *Gary iPhone*.
  - Wait a few minutes until this name is re-registered with the Apple account.
  - Restart iCloud3 to reassign the name to the iCloud3 tracked device.



